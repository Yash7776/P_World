{% load static %}
{% include 'customer/header.html' %}
<style>
	/* Force dark background immediately */
	body, html {
		background-color: #1a1a1a !important;
		color: #f7f7f7 !important;
	}

	.main-content {
		background-color: #1a1a1a;
		min-height: 100vh;
		padding-bottom: 80px;
	}

	.card {
		background-color: #2c2c2c !important;
		border: 1px solid #5e5e5e;
		color: #f7f7f7;
		padding: 30px;
		border-radius: 8px;
		position: relative;
	}

	/* Headings */
	h3 {
		color: #f7f7f7 !important;
		margin: 0;
		text-align: center;
		flex-grow: 1;
	}

	/* Form inputs dark theme */
	.form-control {
		background-color: #3a3a3a !important;
		border: 1px solid #5e5e5e !important;
		color: #f7f7f7 !important;
		padding: 12px;
		font-size: 16px;
		border-radius: 5px;
	}

	.form-control:focus {
		background-color: #444444 !important;
		border-color: #d9534f !important;
		color: #f7f7f7 !important;
		box-shadow: 0 0 0 0.2rem rgba(217, 83, 79, 0.25);
		outline: none;
	}

	.form-control::placeholder {
		color: #bbb6b6 !important;
	}

	/* Error messages */
	span[id^="errmsg"] {
		color: #ff6b6b;
		font-size: 14px;
		display: block;
		margin-top: 5px;
		text-align: left;
		position: relative;
		margin-left: 0 !important;
	}

	/* Buttons */
	.login-btn {
		background-color: #d9534f;
		border: none;
		color: white;
		padding: 12px 30px;
		font-size: 16px;
		font-weight: bold;
		border-radius: 5px;
		cursor: pointer;
		transition: background-color 0.3s;
		width: 100%;
	}

	.login-btn:hover {
		background-color: #c9302c;
	}

	/* Header buttons row */
	.header-controls {
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 20px;
		width: 100%;
	}

	/* Back button styling - circular */
	.back-btn-circle {
		background-color: #d9534f;
		border: none;
		color: white;
		width: 45px;
		height: 45px;
		border-radius: 50%;
		cursor: pointer;
		transition: background-color 0.3s;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.back-btn-circle:hover {
		background-color: #c9302c;
	}

	.back-btn-circle i {
		font-size: 18px;
	}

	/* Delete button styling - circular */
	.delete-btn-circle {
		background-color: transparent;
		border: none;
		color: #d9534f;
		width: 45px;
		height: 45px;
		border-radius: 50%;
		cursor: pointer;
		transition: all 0.3s;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.delete-btn-circle:hover {
		background-color: rgba(217, 83, 79, 0.1);
		color: #c9302c;
	}

	.delete-btn-circle i {
		font-size: 22px;
	}

	/* Form spacing */
	.form-section {
		margin-bottom: 25px;
	}

	/* Pet info display */
	.pet-info-box {
		border: 1px solid #5e5e5e;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
		padding: 15px;
		border-radius: 8px;
		background-color: #3a3a3a;
		margin-bottom: 25px;
	}

	.pet-info-box ul {
		list-style: none;
		padding: 0;
		margin: 0;
	}

	.pet-info-box li {
		padding: 0;
	}

	.pet-info-box img {
		border-radius: 5px;
	}

	#show_img {
		background-size: contain;
		background-repeat: no-repeat;
		background-position: center;
	}

	div.mm-dropdown {
		border: 1px solid #5e5e5e;
		width: 100%;
		border-radius: 5px;
		background-color: #3a3a3a;
	}

	div.mm-dropdown ul {
		list-style: none;
		padding: 0;
		margin: 0;
		border: 0;
	}

	div.mm-dropdown ul li,
	div.mm-dropdown div.textfirst {
		padding: 0;
		color: #c1c1c1;
		border-bottom: 1px solid #5e5e5e;
		padding: 5px 15px;
	}

	div.mm-dropdown div.textfirst {
		background: #3a3a3a;
		color: #afacac;
	}

	div.mm-dropdown div.textfirst img.down {
		float: right;
		margin-top: 5px;
	}

	div.mm-dropdown ul li:last-child {
		border-bottom: 0;
	}

	div.mm-dropdown ul li {
		display: none;
		padding-left: 25px;
		background-color: #3a3a3a;
	}

	div.mm-dropdown ul li.main {
		display: block;
	}

	div.mm-dropdown ul li img {
		width: 20px;
		height: 20px;
	}

	.swal-back {
		width: 350px !important;
		height: auto !important;
	}

	.custom-select {
		width: 50px !important;
	}

	::-webkit-calendar-picker-indicator {
		filter: invert(6);
	}

	.swal-icon--success:after, .swal-icon--success:before {
		background: #262626 !important;
	}

	.swal-icon--success__hide-corners {
		background: #262626;
	}

	/* Responsive adjustments */
	@media (max-width: 768px) {
		.card {
			padding: 25px 20px;
		}
		
		.back-btn-circle,
		.delete-btn-circle {
			width: 40px;
			height: 40px;
		}
		
		.back-btn-circle i {
			font-size: 16px;
		}
		
		.delete-btn-circle i {
			font-size: 20px;
		}
	}
</style>

<!-- Start main-content -->
<div class="main-content">
	<div class='container' style='margin-top: 1.5rem;'>
		<div class='row'>
			<div class='col-md-3'></div>
			<div class='col-md-6'> 
				<!-- Header with back button, title, and delete button -->
				<div class="header-controls">
					<button class="back-btn-circle" onclick="window.location.href='/Reminder/'" data-toggle="tooltip" data-placement="top" title="Back">
						<i class="fa fa-arrow-left" aria-hidden="true"></i>
					</button>
					<h3>Modify Reminder</h3>
					<button class="delete-btn-circle" onclick="Delete_Reminder('{{reminder.id}}')" data-toggle="tooltip" data-placement="top" title="Delete Reminder">
						<i class="fa fa-trash" aria-hidden="true"></i>
					</button>
				</div>
				
				<div class='card shadow'>
					
					<!-- Pet Info Display -->
					<div class="pet-info-box">
						<ul>
							<li class="input-option" data-value="">	
								<div class="row">
									<div class="col-md-4">
										<img src="{{reminder.fk_pet.pet_image.url}}" alt="" width="60" height="40" style="height:82px; width:100px;"/> 
									</div>
									<div class="col-md-6" style="margin-left:2rem;">
										<div class="row" style="text-align:left; color:#d9534f;">{{reminder.fk_pet.pet_name}}</div>
										<div class="row" style="text-align:left; margin-top:10px;">{{reminder.select_date}} {{reminder.select_time}}</div>
									</div>
								</div>	
							</li>
						</ul>
					</div>
					
					<input type="hidden" class="option" id="rem_id" value="{{reminder.id}}" />	
					<span id="errmsg1"></span>
					
					<!-- Reminder -->
					<div class="form-section">
						<input type="text" class="form-control" id="reminder" name="reminder" placeholder="Reminder For*" value="{{reminder.reminder_name}}">
						<span id="errmsg2"></span>
					</div>
					
					<!-- Reminder Date -->
					<div class="form-section">
						<input type='date' id='reminder_date' class="form-control" placeholder='Reminder Date*' value="{{reminder.select_date|date:'Y-m-d'}}">
						<span id="errmsg3"></span>
					</div>
					
					<!-- Reminder Time -->
					<div class="form-section">
						<input type="time" id="reminder_time" name="reminder_time" class="form-control" placeholder='Reminder Time*' value="{{reminder.select_time|time:'h:i:s'}}">
						<span id="errmsg4"></span>
					</div>
					
					<!-- Modify Reminder Button -->
					<button class="login-btn nextBtn btn-danger btn-lg" onclick="Add_Reminder()">Modify Reminder</button>
				</div> 
			</div>
			<div class='col-md-3'></div>
		</div> 
	</div>
</div>

<script>
	$(function() {
		// Set
		var main = $('div.mm-dropdown .textfirst')
		var li = $('div.mm-dropdown > ul > li.input-option')
		var inputoption = $("div.mm-dropdown .option")
		var default_text = 'Select<img src="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-arrow-down-b-128.png" width="10" height="10" class="down" />';

		// Animation
		main.click(function() {
			main.html(default_text);
			li.toggle('fast');
		});

		// Insert Data
		li.click(function() {
			// hide
			li.toggle('fast');
			var livalue = $(this).data('value');
			var lihtml = $(this).html();
			main.html(lihtml);
			inputoption.val(livalue);
		});
	});
</script>

<script>
	function myFunction(id) {	
		$("#pet_id").val(id);
		$("#errmsg1").hide();
	}

	$('#reminder').change(function(){
		$('#errmsg2').hide();
	});
	
	$('#reminder_date').change(function(){
		$('#errmsg3').hide();
	});

	$('#reminder_time').change(function(){
		$('#errmsg4').hide();
	});
	
	function Add_Reminder() {
		rem_id = $("#rem_id").val();
		reminder = $("#reminder").val();
		reminder_date = $("#reminder_date").val();
		reminder_time = $("#reminder_time").val();
		
		if(reminder == "") {
			$("#errmsg2").html("Enter Reminder For");
			$("#errmsg2").show();
		}
		else if(reminder_date == "") {
			$("#errmsg3").html("Select Reminder Date");
			$("#errmsg3").show();
		}
		else if(reminder_time == "") {
			$("#errmsg4").html("Select Reminder Time");
			$("#errmsg4").show();
		}
		else {
			$.ajax({
				method:"POST",
				url:"/update_reminder_pet_api/",
				headers : {'X-CSRFToken' : getCookie('csrftoken')},
				data:{
					"rem_id": rem_id,
					"reminder_name":reminder,
					"select_date":reminder_date,
					"select_time":reminder_time,
					"token": '',
				},
				success: function(response){
					if(response.status ==200){
						swal(""+response.msg+"", {
							icon: "success",
							button: "Ok",
							closeOnClickOutside: false,
						})
						.then((addcat)=>{
							if(addcat){
								window.location.href="/Reminder/";
							}
						});
					}
					else{
						swal(""+response.msg+"", {
							icon: "error",
							button: "Ok",
							closeOnClickOutside: false,
						});
					}
				}  
			});
		}
	}
	
	function Delete_Reminder(reminder_id) {
		swal({
			title: "Delete Reminder.",
			text: "Do you want to delete this Pet Reminder?",
			icon: "warning",
			buttons: ["No", "Yes"],
			html:true,
			className: "swal-back",
			closeOnClickOutside: false,
			dangerMode: true,			
		})		
		.then((willUpdate) => {
			if (willUpdate) {
				$.ajax({
					type:"POST",
					url: "/delete_reminder_pet_api/",
					headers : {'X-CSRFToken' : getCookie('csrftoken')},
					data: {
						'reminder_id': reminder_id
					},
					success: function (response) {
						if (response.status == 200){
							swal(""+response.msg+"", {
								icon: "success",
								button: "Ok",
								closeOnClickOutside: false,
							})
							.then((addcat)=>{
								if(addcat){
									window.location.href="/Reminder/";
								}
							});
						}
						else{
							swal(""+response.msg+"", {
								icon: "error",
								button: "Ok",
								closeOnClickOutside: false,
							});
						}
					}
				})
			}	
		});
	}
</script>

{% include 'customer/footer.html' %}