{% load static %}
{% include 'customer/header.html' %}
 <style>
  
 
.swal-icon--success:after, .swal-icon--success:before {
 background: #262626 !important;
	 }
.swal-icon--success__hide-corners {
	background: #262626;
}


p{
color: #d5d5d5;
font-weight: bold;
}  
  
 
 </style>
  <!-- Start main-content -->
  <div class="main-content">
    <!-- Section: inner-header -->
      <div class='container text-center'>
			<div class="row" style='margin-top:2rem;margin-bottom:1rem;'>
				<div class="col-lg-4"></div>
				<div class="col-lg-4">
				{% if appointment %}
					<h4 style="color:#fff;margin:0">All APPOINTMENTS</h4>
				{% endif %}
				</div>
				
				<div class="col-lg-2"  >
					<button class="login-btn nextBtn btn-danger btn-sm" onclick="window.location.href='/doctors_appointment/'"><i class="fa fa-arrow-left" aria-hidden="true" style="cursor:pointer;" data-toggle="tooltip" data-placement="top" title="Back" ></i></button>
				</div>
			</div>
			
		<div class='row'>
		    <div class="col-md-3"></div>
		      <div class="col-md-7">  
				<div class='card shadow text-center'  > 
				{% if appointment %} 
					<div class="reminder overflow-auto" id="reminder" style="overflow-x:hidden; max-height:600px !important;  overflow-y: auto;">
						{% for i in appointment %}
								<div style='border: 3px solid #504e4e;box-shadow: 2px 2px 9px 0px grey; padding: 10px 0px 10px 0px;width: 98%;' > 
									<div class="row ">
										<div class="col-md-3">
										  <img {% if i.fk_pet.pet_image.url %} src="{{i.fk_pet.pet_image.url}}" {% else %} src="/media/profile_image/no_image.jpg "  {% endif %} alt="" width="60" height="40" style="height:82px; width:100px;"/> 
										</div>
										<div class="col-md-6 text-left" style='margin-left:2rem;'>
											 <p style='margin-bottom:0;'>{{i.fk_pet.pet_name}}</p> 
											 <p style='margin-bottom:0;'>{{i.fk_pet.breed}}<p> 
											 <p style='margin-bottom:0;'>{{i.booking_date}} , {{i.booking_time}} <p> 
										</div>
										<div class="col-md-2 text-right">  
											{% if i.book_status == "Booked" %} 	 
											<button class="login-btn nextBtn btn-danger mr-10 btn-sm" onclick="Cancel_Appointment('{{i.id}}')">Cancel</button>  
											{% else %}
											 <p class='mr-10' {% if i.book_status == 'Completed' %} style='color:#128112;' {% elif i.book_status == 'Cancelled' %} style='color:#dd1717;' {% else %} style='color:#1c7d9b;' {% endif %}  >{{i.book_status}}</p>
											{% endif %}
										</div>
									</div> 
								</div>
								<br>
						{% endfor %}
					</div>
				{% else %}
					<div class="row" style="margin-top: 2%;">
						<h2>No Appointments Available.</h2>
						
					</div>
				{% endif %}
				
		    </div>
		   </div>
		</div>
		 
		   </div>
	  </div>
  </div>
  
	
			  
  <!-- end main-content -->
 <script>
	function Cancel_Appointment(appointment_id)
	{
		
		swal({
			title: "Cancel Appointment.",
			text: "Do you want to cancel this appointment?",
			icon: "warning",
			buttons: ["No", "Yes"],
			html:true,
			className: "swal-back",
			closeOnClickOutside: false,
			dangerMode: true,			
		})		
		.then((willUpdate) => {
			if (willUpdate) {
				$.ajax({
					type:"POST",
					url: "/cancel_doctors_appointment_api/",
					headers : {'X-CSRFToken' : getCookie('csrftoken')},
					data: {
						'id': appointment_id,
						'book_status':'Cancelled',
						"cancelled_by": "Doctor"
					},
					success: function (response) 
					{
						if (response.status == 200){
							swal("Doctor Appointment Cancelled Successfully.", {
								icon: "success",
								button: "Ok",
								closeOnClickOutside: false,
								
							})
							.then((addcat)=>{
						   if(addcat){
						    window.location.reload();
						   }
						});
							
						}
						else{
							swal(""+response.msg+"", {
							icon: "error",
							button: "Ok",
							closeOnClickOutside: false,
							});
						}
					}
					
				})
				
			}	
		});
	}
    
 
 </script>
  {% include 'customer/footer.html' %}